<!doctype html>
<html lang="en" data-vocs>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/initializeTheme.iife.js"></script><link rel="preload" as="image" href="/logo.png"/><title>StreamableHTTP Transport – MCP-Go</title><meta property="og:type" content="website"/><meta property="og:title" content="StreamableHTTP Transport"/><meta property="og:url" content="https://mcp-go.dev"/><meta name="twitter:card" content="summary_large_image"/>
    <script type="module" crossorigin src="/assets/index-CLhvWHyZ.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/style-3fK4AU4f.css">
  </head>
  <body>
    <div id="app"><base href="https://mcp-go.dev"/><div class="vocs_DocsLayout" data-layout="docs"><a class="vocs_SkipLink vocs_utils_visuallyHidden" href="/transports/http#vocs-content">Skip to content</a><div class="vocs_DocsLayout_gutterLeft"><aside class="vocs_Sidebar vocs_DocsLayout_sidebar"><div><div class="vocs_Sidebar_logoWrapper"><div class="vocs_Sidebar_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/logo.png"/></a></div><div class="vocs_Sidebar_divider"></div></div><nav class="vocs_Sidebar_navigation"><div class="vocs_Sidebar_group"><section class="vocs_Sidebar_section"><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/getting-started" variant="styleless" data-discover="true">Getting Started</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/quick-start" variant="styleless" data-discover="true">Quick Start</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/core-concepts" variant="styleless" data-discover="true">Core Concepts</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Building MCP Servers</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers" variant="styleless" data-discover="true">Overview</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers/basics" variant="styleless" data-discover="true">Server Basics</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers/resources" variant="styleless" data-discover="true">Resources</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers/tools" variant="styleless" data-discover="true">Tools</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers/prompts" variant="styleless" data-discover="true">Prompts</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/servers/advanced" variant="styleless" data-discover="true">Advanced Features</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Transport Options</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/transports" variant="styleless" data-discover="true">Overview</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/transports/stdio" variant="styleless" data-discover="true">STDIO Transport</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/transports/sse" variant="styleless" data-discover="true">SSE Transport</a><a data-active="true" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/transports/http" variant="styleless" data-discover="true">HTTP Transport</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/transports/inprocess" variant="styleless" data-discover="true">In-Process Transport</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Building MCP Clients</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/clients" variant="styleless" data-discover="true">Overview</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/clients/basics" variant="styleless" data-discover="true">Client Basics</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/clients/operations" variant="styleless" data-discover="true">Client Operations</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/clients/transports" variant="styleless" data-discover="true">Client Transports</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level vocs_Sidebar_levelCollapsed"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Advanced</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse vocs_Sidebar_sectionCollapseActive" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div></section></div></nav></div><div class="vocs_Sidebar_footer"><div class="vocs_Sidebar_footerCurtain"></div><div class="vocs_Sidebar_footerContent"><div class="vocs_Socials"><a class="vocs_Socials_button" href="https://github.com/mark3labs/mcp-go" target="_blank" rel="noopener noreferrer"><div aria-label="GitHub" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg width="100%" height="100%" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path></svg></div></a></div></div></div></aside></div><div class="vocs_DocsLayout_gutterTop vocs_DocsLayout_gutterTop_offsetLeftGutter"><div class="vocs_DesktopTopNav"><button class="vocs_DesktopSearch_search" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rlj»" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:2px"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>Search...<div class="vocs_DesktopSearch_searchCommand"><div style="background:currentColor;transform:rotate(45deg);width:1.5px;border-radius:2px;height:100%"></div></div></button><div class="vocs_DesktopTopNav_logoWrapper"><div class="vocs_DesktopTopNav_logo"><a style="align-items:center;display:flex;height:56px;margin-top:4px" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/logo.png"/></a></div></div><div class="vocs_DesktopTopNav_section"></div><div class="vocs_DesktopTopNav_section"></div></div><div class="vocs_MobileTopNav"><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group"><div class="vocs_MobileTopNav_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/logo.png"/></a></div></div><div class="vocs_MobileTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_MobileTopNav_navigation vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"></ul></div></nav><div class="vocs_MobileTopNav_navigation vocs_MobileTopNav_navigation_compact"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rkpj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger vocs_MobileTopNav_navigationItem">Menu<div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Down</title><path d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group" style="margin-right:-8px"><button class="vocs_MobileSearch_searchButton" type="button" aria-label="Search" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R19j»" data-state="closed"><svg width="21" height="21" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div><div class="vocs_DocsLayout_gutterTopCurtain vocs_DocsLayout_gutterTopCurtain_withSidebar"><div class="vocs_DesktopTopNav_curtain"></div><div class="vocs_MobileTopNav_curtain"><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rqj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger"><div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:13px"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 79 48" fill="none"><title>Menu</title><path fill="currentColor" d="M19.528 47.232h40.87c1.952 0 3.515-1.562 3.515-3.564a3.5 3.5 0 0 0-3.516-3.516H19.528a3.501 3.501 0 0 0-3.515 3.516c0 2.002 1.562 3.564 3.515 3.564ZM12.057 27.262h55.81a3.501 3.501 0 0 0 3.516-3.516 3.501 3.501 0 0 0-3.515-3.515h-55.81a3.501 3.501 0 0 0-3.516 3.515 3.501 3.501 0 0 0 3.515 3.516ZM4.391 7.34H75.29c2.002 0 3.515-1.563 3.515-3.516 0-2.002-1.513-3.564-3.515-3.564H4.39C2.438.26.876 1.822.876 3.824A3.501 3.501 0 0 0 4.39 7.34Z"></path></svg></div><div class="vocs_MobileTopNav_menuTitle">HTTP Transport</div></button></div></div><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R5aj»" data-state="closed" class="vocs_MobileTopNav_outlineTrigger">On this page<div aria-label="On this page" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div></div><div class="vocs_DocsLayout_gutterRight vocs_DocsLayout_gutterRight_withSidebar"></div><div id="vocs-content" class="vocs_DocsLayout_content vocs_DocsLayout_content_withSidebar vocs_DocsLayout_content_withTopNav"><article class="vocs_Content"><header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="streamablehttp-transport" class="vocs_Heading_slugTarget"></div>StreamableHTTP Transport<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#streamablehttp-transport" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<p class="vocs_Paragraph">StreamableHTTP transport provides traditional request/response communication for MCP servers, perfect for REST-like interactions, stateless clients, and integration with existing web infrastructure.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="use-cases" class="vocs_Heading_slugTarget"></div>Use Cases<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#use-cases" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">StreamableHTTP transport excels in scenarios requiring:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Web services</strong>: Traditional REST API patterns</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Stateless interactions</strong>: Each request is independent</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Load balancing</strong>: Distribute requests across multiple servers</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Caching</strong>: Leverage HTTP caching mechanisms</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Integration</strong>: Work with existing HTTP infrastructure</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Public APIs</strong>: Expose MCP functionality as web APIs</li>
</ul>
<strong class="vocs_Strong">Example applications:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Microservice architectures</li>
<li class="vocs_ListItem">Public API endpoints</li>
<li class="vocs_ListItem">Integration with API gateways</li>
<li class="vocs_ListItem">Cached data services</li>
<li class="vocs_ListItem">Rate-limited services</li>
<li class="vocs_ListItem">Multi-tenant applications</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="implementation" class="vocs_Heading_slugTarget"></div>Implementation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#implementation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="basic-streamablehttp-server" class="vocs_Heading_slugTarget"></div>Basic StreamableHTTP Server<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#basic-streamablehttp-server" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">package</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> main</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">import</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">context</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">fmt</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">log</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">net/http</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">strings</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">github.com/mark3labs/mcp-go/mcp</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    &quot;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">github.com/mark3labs/mcp-go/server</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> main</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewMCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;StreamableHTTP API Server&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1.0.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithToolCapabilities</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithResourceCapabilities</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add RESTful tools</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;get_user&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithDescription</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Get user information&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user_id&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Required</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        handleGetUser,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;create_user&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithDescription</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Create a new user&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;name&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Required</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;email&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Required</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithNumber</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;age&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Min</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        handleCreateUser,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;search_users&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithDescription</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Search users with filters&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;query&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Description</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Search query&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithNumber</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;limit&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">DefaultNumber</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">10</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">), mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Max</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">100</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithNumber</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;offset&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">DefaultNumber</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">), mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Min</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        handleSearchUsers,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add resources</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddResource</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewResource</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">            &quot;users://{user_id}&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">            &quot;User Profile&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithResourceDescription</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;User profile data&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithMIMEType</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;application/json&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        handleUserResource,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Start StreamableHTTP server</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Println</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Starting StreamableHTTP server on :8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    httpServer </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewStreamableHTTPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> httpServer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Start</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;:8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">); err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Fatal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleGetUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    userID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user_id&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> userID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user_id is required&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Simulate database lookup</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    user, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getUserFromDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(userID)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user not found: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, userID)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultText</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">`{&quot;id&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;name&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;email&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;age&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">}`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        user.ID, user.Name, user.Email, user.Age)), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleCreateUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    name </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;name&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    email </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;email&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    age </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetInt</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;age&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> name </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;&quot;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> ||</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> email </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;name and email are required&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Validate input</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">isValidEmail</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(email) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;invalid email format: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, email)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Create user</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    user </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ID:        </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">generateID</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Name:      name,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Email:     email,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Age:       age,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        CreatedAt: time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> saveUserToDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(user); err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;failed to create user: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultText</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">`{&quot;id&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;message&quot;:&quot;User created successfully&quot;,&quot;user&quot;:{&quot;id&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;name&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;email&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;age&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">}}`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        user.ID, user.ID, user.Name, user.Email, user.Age)), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Helper functions and types for the examples</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> User</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ID        </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    `json:&quot;id&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Name      </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    `json:&quot;name&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Email     </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">    `json:&quot;email&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Age       </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">int</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">       `json:&quot;age&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    CreatedAt </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Time</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> `json:&quot;created_at&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getUserFromDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">userID</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ID:    userID,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Name:  </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;John Doe&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Email: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;john@example.com&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Age:   </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">30</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> isValidEmail</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">email</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">bool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> strings.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Contains</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(email, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;@&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> strings.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Contains</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(email, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;.&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> generateID</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user_</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">UnixNano</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">())</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> saveUserToDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">user</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleSearchUsers</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    query </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;query&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    limit </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetInt</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;limit&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">10</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    offset </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetInt</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;offset&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Search users with pagination</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    users, total, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> searchUsersInDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(query, limit, offset)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;search failed: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultText</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">`{&quot;users&quot;:[{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;John Doe&quot;,&quot;email&quot;:&quot;john@example.com&quot;,&quot;age&quot;:30},{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;Jane Smith&quot;,&quot;email&quot;:&quot;jane@example.com&quot;,&quot;age&quot;:25}],&quot;total&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">,&quot;limit&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">,&quot;offset&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">,&quot;query&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;}`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        total, limit, offset, query)), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleUserResource</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ReadResourceRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) ([]</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResourceContents</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    userID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> extractUserIDFromURI</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(req.Params.URI)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    user, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getUserFromDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(userID)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user not found: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, userID)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> []</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResourceContents</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TextResourceContents</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            URI:      req.Params.URI,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            MIMEType: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;application/json&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            Text:     fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">`{&quot;id&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;name&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;email&quot;:&quot;</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;,&quot;age&quot;:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%d</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">}`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, user.ID, user.Name, user.Email, user.Age),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Additional helper functions</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> searchUsersInDB</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">query</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">limit</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">offset</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> int</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) ([]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">int</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    users </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> []</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">User</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        {ID: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Name: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;John Doe&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Email: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;john@example.com&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Age: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">30</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">},</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        {ID: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;2&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Name: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Jane Smith&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Email: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;jane@example.com&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, Age: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">25</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">},</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> users, </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">len</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(users), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> extractUserIDFromURI</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">uri</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Extract user ID from URI like &quot;users://123&quot;</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> len</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(uri) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 8</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> uri[:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">8</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;users://&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> uri[</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">8</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> uri</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="advanced-streamablehttp-configuration" class="vocs_Heading_slugTarget"></div>Advanced StreamableHTTP Configuration<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#advanced-streamablehttp-configuration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> main</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewMCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Advanced StreamableHTTP Server&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1.0.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithResourceCapabilities</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithPromptCapabilities</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithToolCapabilities</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithLogging</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add comprehensive tools and resources</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">    addCRUDTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s)</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">    addBatchTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s)</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">    addAnalyticsTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s)</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Println</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Starting advanced StreamableHTTP server on :8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    httpServer </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewStreamableHTTPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithEndpointPath</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/api/v1/mcp&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithHeartbeatInterval</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">30</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">time.Second),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithStateLess</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">false</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> httpServer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Start</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;:8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">); err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Fatal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Helper functions for the advanced example</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> addCRUDTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">s</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation - would add CRUD tools</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> addBatchTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">s</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation - would add batch processing tools</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> addAnalyticsTools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">s</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation - would add analytics tools</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> logToolCall</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sessionID</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">toolName</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">duration</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Duration</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">err</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Printf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Tool </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> failed: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%v</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, toolName, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    } </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">else</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Printf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Tool </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> completed in </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%v</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, toolName, duration)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> logResourceRead</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sessionID</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">uri</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">duration</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Duration</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">err</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Placeholder implementation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Printf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Resource read </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> failed: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%v</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, uri, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    } </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">else</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Printf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Resource read </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> completed in </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%v</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, uri, duration)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> addStreamableHTTPMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">s</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Authentication middleware</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddToolMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">next</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ToolHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ToolHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Extract and validate auth token</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            token </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> extractAuthToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">                return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;authentication required&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            user, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> validateToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(token)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">                return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;invalid token: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Add user to context</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            ctx </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> context.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithValue</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, user)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> next</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, req)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Rate limiting middleware</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddToolMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">next</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ToolHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ToolHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            clientIP </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getClientIP</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">rateLimiter.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Allow</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(clientIP) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">                return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;rate limit exceeded&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> next</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, req)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Caching middleware</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddResourceMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">next</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResourceHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">server</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResourceHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ReadResourceRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ReadResourceResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Check cache first</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> cached </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getFromCache</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(req.Params.URI); cached </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">                return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> cached, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            result, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> next</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, req)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">                // Cache successful results</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">                setCache</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(req.Params.URI, result, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">5</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">time.Minute)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> result, err</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h2 class="vocs_H2 vocs_Heading"><div id="endpoints" class="vocs_Heading_slugTarget"></div>Endpoints<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#endpoints" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="standard-mcp-endpoints" class="vocs_Heading_slugTarget"></div>Standard MCP Endpoints<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#standard-mcp-endpoints" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">When you start a StreamableHTTP MCP server, it automatically creates these endpoints:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/initialize     - Initialize MCP session</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/tools/list     - List available tools</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/tools/call     - Call a tool</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/resources/list - List available resources</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/resources/read - Read a resource</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/prompts/list   - List available prompts</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/prompts/get    - Get a prompt</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">GET  /mcp/health         - Health check</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">GET  /mcp/capabilities   - Server capabilities</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="custom-endpoints" class="vocs_Heading_slugTarget"></div>Custom Endpoints<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#custom-endpoints" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Add custom HTTP endpoints alongside MCP:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> main</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    s </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewMCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Custom StreamableHTTP Server&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1.0.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Create HTTP server with custom routes</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewServeMux</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add MCP endpoints</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Handle</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/mcp&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewStreamableHTTPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(s))</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add custom endpoints</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HandleFunc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/api/status&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, handleStatus)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HandleFunc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/api/metrics&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, handleMetrics)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HandleFunc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/api/users&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, handleUsersAPI)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mux.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HandleFunc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;/api/upload&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, handleFileUpload)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Add middleware</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    handler </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> addMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(mux)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Println</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Starting custom StreamableHTTP server on :8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">ListenAndServe</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;:8080&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, handler); err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        log.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Fatal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleStatus</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">w</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">r</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Request</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    status </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">interface</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}{</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">        &quot;status&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:    </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;healthy&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">        &quot;timestamp&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Unix</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">        &quot;version&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:   </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1.0.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">        &quot;uptime&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:    time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Since</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(startTime).</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    w.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Header</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Set</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Content-Type&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;application/json&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    json.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewEncoder</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w).</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Encode</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(status)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleMetrics</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">w</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">r</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Request</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    metrics </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> collectMetrics</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    w.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Header</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Set</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Content-Type&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;application/json&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    json.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewEncoder</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w).</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Encode</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(metrics)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleUsersAPI</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">w</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">r</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Request</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    switch</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> r.Method {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    case</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;GET&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">        handleListUsers</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, r)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    case</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;POST&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">        handleCreateUserAPI</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, r)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    case</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;PUT&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">        handleUpdateUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, r)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    case</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;DELETE&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">        handleDeleteUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, r)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    default</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Method not allowed&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, http.StatusMethodNotAllowed)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="requestresponse-patterns" class="vocs_Heading_slugTarget"></div>Request/Response Patterns<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#requestresponse-patterns" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="standard-mcp-request" class="vocs_Heading_slugTarget"></div>Standard MCP Request<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#standard-mcp-request" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">POST /mcp/tools/call</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">Content-Type: application/json</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;jsonrpc&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;2.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;id&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;method&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;tools/call&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;params&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;name&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;search_users&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;arguments&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">      &quot;query&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;john&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">      &quot;limit&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">10</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">      &quot;offset&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">  }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="standard-mcp-response" class="vocs_Heading_slugTarget"></div>Standard MCP Response<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#standard-mcp-response" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;jsonrpc&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;2.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;id&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;result&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;content&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: [</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">      {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">        &quot;type&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;text&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">        &quot;text&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;{</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">users</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">:[...],</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">total</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">:25,</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">limit</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">:10,</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">offset</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">\&quot;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">:0}&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">      }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">  }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="error-response" class="vocs_Heading_slugTarget"></div>Error Response<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#error-response" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;jsonrpc&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;2.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;id&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">  &quot;error&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;code&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">-32602</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;message&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Invalid params&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">    &quot;data&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#8DDB8C" class="vocs_Span">      &quot;details&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user_id is required&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">  }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h2 class="vocs_H2 vocs_Heading"><div id="session-management" class="vocs_Heading_slugTarget"></div>Session Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#session-management" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="stateful-vs-stateless" class="vocs_Heading_slugTarget"></div>Stateful vs Stateless<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#stateful-vs-stateless" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="stateless-design-recommended" class="vocs_Heading_slugTarget"></div>Stateless Design (Recommended)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#stateless-design-recommended" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Each request is independent</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleStatelessTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Extract all needed information from request</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    userID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> extractUserFromToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    params </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.Params.Arguments</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Process without relying on server state</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    result, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> processRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(userID, params)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultJSON</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(result)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Use external storage for persistence</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getUserPreferences</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">userID</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">interface</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Load from database, cache, etc.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> loadFromRedis</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user:</span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%s</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">:prefs&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, userID))</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="stateful-design-when-needed" class="vocs_Heading_slugTarget"></div>Stateful Design (When Needed)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#stateful-design-when-needed" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HTTPSessionManager</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sessions </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSession</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mutex    </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">sync</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RWMutex</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    cleanup  </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Ticker</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HTTPSession</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ID          </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    UserID      </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    CreatedAt   </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Time</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    LastAccess  </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Time</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Data        </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">interface</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ExpiresAt   </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Time</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> NewHTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sm </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        sessions: </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">make</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        cleanup:  time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewTicker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.Minute),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    go</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">cleanupExpiredSessions</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sm </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">CreateSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">userID</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Lock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    defer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Unlock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    session </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ID:         </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">generateSessionID</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        UserID:     userID,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        CreatedAt:  time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        LastAccess: time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Data:       </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">make</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">interface</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ExpiresAt:  time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Add</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">30</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.Minute),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sm.sessions[session.ID] </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> session</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> session</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sm </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sessionID</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSession</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">bool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">RLock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    defer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">RUnlock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    session, exists </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.sessions[sessionID]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">exists </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">||</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">After</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(session.ExpiresAt) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">false</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Update last access</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    session.LastAccess </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    session.ExpiresAt </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">().</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Add</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">30</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.Minute)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> session, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">true</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">sm </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HTTPSessionManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">cleanupExpiredSessions</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    for</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> range</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.cleanup.C {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Lock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        now </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> time.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Now</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        for</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> id, session </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> range</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sm.sessions {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> now.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">After</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(session.ExpiresAt) {</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">                delete</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(sm.sessions, id)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        sm.mutex.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Unlock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="authentication-and-authorization" class="vocs_Heading_slugTarget"></div>Authentication and Authorization<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#authentication-and-authorization" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AuthMiddleware</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    jwtSecret []</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">byte</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    userStore </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UserStore</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> NewAuthMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">secret</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> []</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">byte</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">store</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> UserStore</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AuthMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AuthMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        jwtSecret: secret,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        userStore: store,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">m </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AuthMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Middleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">next</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Handler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Handler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HandlerFunc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">w</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">r</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">http</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Request</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Extract token from Authorization header</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        authHeader </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> r.Header.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Get</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Authorization&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">strings.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">HasPrefix</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(authHeader, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Bearer &quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Missing or invalid authorization header&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, http.StatusUnauthorized)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        token </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> strings.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">TrimPrefix</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(authHeader, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Bearer &quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Validate JWT token</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        claims, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> m.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">validateJWT</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(token)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Invalid token&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, http.StatusUnauthorized)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Load user information</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        user, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> m.userStore.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(claims.UserID)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            http.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;User not found&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, http.StatusUnauthorized)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Add user to request context</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ctx </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> context.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithValue</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(r.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(), </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, user)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        next.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">ServeHTTP</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(w, r.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithContext</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx))</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">m </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AuthMiddleware</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">validateJWT</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">tokenString</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Claims</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Note: This example uses a hypothetical JWT library</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // In practice, you would use a real JWT library like github.com/golang-jwt/jwt</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    token, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> jwt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">ParseWithClaims</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(tokenString, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Claims</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">token</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> *</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">jwt</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Token</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">interface</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{}, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> m.jwtSecret, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> claims, ok </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token.Claims.(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Claims</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">); ok </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token.Valid {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> claims, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;invalid token&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Claims</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    UserID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> `json:&quot;user_id&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Role   </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> `json:&quot;role&quot;`</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    jwt</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">StandardClaims</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="request-headers" class="vocs_Heading_slugTarget"></div>Request Headers<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#request-headers" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The StreamableHTTP transport now passes HTTP request headers to MCP handlers. This allows you to access the original HTTP headers that were sent with the request in your tool and resource handlers.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="accessing-headers-in-handlers" class="vocs_Heading_slugTarget"></div>Accessing Headers in Handlers<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#accessing-headers-in-handlers" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Headers are available in all MCP request objects:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> handleGetUser</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Access request headers</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    headers </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> req.Header</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Use headers for authentication, tracing, etc.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    authToken </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> headers.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Get</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Authorization&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> authToken </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">==</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> &quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;authentication required&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Access other headers</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    requestID </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> headers.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Get</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;X-Request-ID&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    userAgent </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> headers.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Get</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;User-Agent&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Rest of your handler code...</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph">This works for all MCP request types including:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">CallToolRequest</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">ReadResourceRequest</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">ListToolsRequest</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">ListResourcesRequest</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">InitializeRequest</code></li>
<li class="vocs_ListItem">And other MCP request types</li>
</ul>
<p class="vocs_Paragraph">The headers are automatically populated by the transport layer and are available in your handlers without any additional configuration.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="sampling-support" class="vocs_Heading_slugTarget"></div>Sampling Support<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#sampling-support" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">StreamableHTTP transport now supports bidirectional sampling, allowing servers to request LLM completions from clients. This enables advanced scenarios where servers can leverage client-side LLM capabilities.</p>
<aside class="vocs_Aside vocs_Callout vocs_Callout_warning"><div class="vocs_Callout_icon"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Exclamation</title><path d="M8.4449 0.608765C8.0183 -0.107015 6.9817 -0.107015 6.55509 0.608766L0.161178 11.3368C-0.275824 12.07 0.252503 13 1.10608 13H13.8939C14.7475 13 15.2758 12.07 14.8388 11.3368L8.4449 0.608765ZM7.4141 1.12073C7.45288 1.05566 7.54712 1.05566 7.5859 1.12073L13.9798 11.8488C14.0196 11.9154 13.9715 12 13.8939 12H1.10608C1.02849 12 0.980454 11.9154 1.02018 11.8488L7.4141 1.12073ZM6.8269 4.48611C6.81221 4.10423 7.11783 3.78663 7.5 3.78663C7.88217 3.78663 8.18778 4.10423 8.1731 4.48612L8.01921 8.48701C8.00848 8.766 7.7792 8.98664 7.5 8.98664C7.2208 8.98664 6.99151 8.766 6.98078 8.48701L6.8269 4.48611ZM8.24989 10.476C8.24989 10.8902 7.9141 11.226 7.49989 11.226C7.08567 11.226 6.74989 10.8902 6.74989 10.476C6.74989 10.0618 7.08567 9.72599 7.49989 9.72599C7.9141 9.72599 8.24989 10.0618 8.24989 10.476Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div><div class="vocs_Callout_content"><strong data-callout-title="true" class="vocs_Strong">Security: Human-in-the-Loop Required</strong><p class="vocs_Paragraph">Per the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://modelcontextprotocol.io/specification/2025-06-18/client/sampling" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">MCP specification</a>, implementations <strong class="vocs_Strong">SHOULD</strong> always include a human in the loop with the ability to deny sampling requests.</p><strong class="vocs_Strong">Your sampling handler implementation MUST:</strong><ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Present sampling requests to users for review before execution</li>
<li class="vocs_ListItem">Allow users to view and edit prompts before sending to the LLM</li>
<li class="vocs_ListItem">Display generated responses for approval before returning to the server</li>
<li class="vocs_ListItem">Provide clear UI to accept or reject sampling requests</li>
</ul><p class="vocs_Paragraph">Failing to implement approval flows creates serious security and trust risks, including:</p><ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Servers making unauthorized LLM requests on behalf of users</li>
<li class="vocs_ListItem">Exposure of sensitive data through unreviewed prompts</li>
<li class="vocs_ListItem">Uncontrolled API costs from automated sampling</li>
<li class="vocs_ListItem">Lack of user consent for AI interactions</li>
</ul><p class="vocs_Paragraph">See the <a class="vocs_Anchor" href="/transports/http#example-with-approval-flow">example implementation</a> below for a reference approval pattern.</p></div></aside>
<h3 class="vocs_H3 vocs_Heading"><div id="requirements-for-sampling" class="vocs_Heading_slugTarget"></div>Requirements for Sampling<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#requirements-for-sampling" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">To enable sampling with StreamableHTTP transport, the client <strong class="vocs_Strong">must</strong> use the <code class="vocs_Code">WithContinuousListening()</code> option:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Client setup with sampling support</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">httpTransport, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> transport.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewStreamableHTTP</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    serverURL,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    transport.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithContinuousListening</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(), </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Required for sampling</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Create client with sampling handler</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">mcpClient </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> client.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewClient</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(httpTransport, </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    client.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">WithSamplingHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(samplingHandler))</span></span></code></pre></div></div>
<p class="vocs_Paragraph">Without <code class="vocs_Code">WithContinuousListening()</code>, the client won&#x27;t maintain a persistent connection to receive sampling requests from the server.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="server-side-implementation" class="vocs_Heading_slugTarget"></div>Server-Side Implementation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#server-side-implementation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Enable sampling in your StreamableHTTP server:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">mcpServer </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> server.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewMCPServer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;HTTP Sampling Server&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;1.0.0&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">mcpServer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">EnableSampling</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Add a tool that uses sampling</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">mcpServer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">AddTool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Tool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Name:        </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;ask-llm&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Description: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Ask the LLM a question&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    InputSchema: </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ToolInputSchema</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Type: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;object&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Properties: </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">any</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">            &quot;question&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">map</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">any</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">                &quot;type&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">:        </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;string&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">                &quot;description&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Question to ask&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Required: []</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;question&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">},</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">req</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CallToolResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    question </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">ParseString</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(req, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;question&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Request sampling from client</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    samplingRequest </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CreateMessageRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Request: </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Request</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            Method: </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(mcp.MethodSamplingCreateMessage),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        CreateMessageParams: </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CreateMessageParams</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            Messages: []</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">SamplingMessage</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                    Role: mcp.RoleUser,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                    Content: </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TextContent</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">{</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                        Type: </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;text&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                        Text: question,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                    },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            MaxTokens: </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        },</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    result, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcpServer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">RequestSampling</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, samplingRequest)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultError</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Sprintf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Sampling failed: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%v</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">NewToolResultText</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(mcp.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">GetTextFromContent</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(result.Content)), </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">})</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="how-it-works" class="vocs_Heading_slugTarget"></div>How It Works<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#how-it-works" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Persistent Connection</strong>: When <code class="vocs_Code">WithContinuousListening()</code> is enabled, the client maintains a persistent SSE connection to the server</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Bidirectional Communication</strong>: The server can send sampling requests through the SSE stream</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Response Channel</strong>: The client responds to sampling requests via HTTP POST to the same endpoint</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Session Correlation</strong>: Responses are correlated using session IDs to ensure they reach the correct handler</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="limitations" class="vocs_Heading_slugTarget"></div>Limitations<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#limitations" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Sampling requires <code class="vocs_Code">WithContinuousListening()</code> to maintain the SSE connection</li>
<li class="vocs_ListItem">Without continuous listening, the transport operates in stateless request/response mode only</li>
<li class="vocs_ListItem">Network interruptions may require reconnection and re-establishment of the sampling channel</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="example-with-approval-flow" class="vocs_Heading_slugTarget"></div>Example with Approval Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#example-with-approval-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Here&#x27;s a reference implementation showing proper human-in-the-loop approval:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">type</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> ApprovalSamplingHandler</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    llmClient </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">LLMClient</span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span"> // Your actual LLM client</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ui        </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UserInterface</span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span"> // Your UI for presenting requests to users</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">func</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">h </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ApprovalSamplingHandler</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">CreateMessage</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">ctx</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Context</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">request</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CreateMessageRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">mcp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">CreateMessageResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">error</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Step 1: Present the sampling request to the user for review</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    approved, modifiedRequest, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> h.ui.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">PresentSamplingRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, request)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;failed to get user approval: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">approved {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user rejected sampling request&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Step 2: Send the approved/modified request to the LLM</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    response, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> h.llmClient.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">CreateCompletion</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, modifiedRequest)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;LLM request failed: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Step 3: Present the response to the user for final approval</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    approved, modifiedResponse, err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> h.ui.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">PresentSamplingResponse</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(ctx, response)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> err </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">!=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;failed to get response approval: </span><span style="color:#005CC5;--shiki-dark:#F47067" class="vocs_Span">%w</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, err)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">approved {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> nil</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Errorf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;user rejected sampling response&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    </span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Step 4: Return the approved response to the server</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> modifiedResponse, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">nil</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<strong class="vocs_Strong">Key Points:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Users must explicitly approve both the request (before sending to LLM) and the response (before returning to server)</li>
<li class="vocs_ListItem">Users can modify prompts or responses before approval</li>
<li class="vocs_ListItem">Rejection at any stage returns an error to the server</li>
<li class="vocs_ListItem">The UI should clearly display what the server is requesting and why</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="next-steps" class="vocs_Heading_slugTarget"></div>Next Steps<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/transports/http#next-steps" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="/transports/inprocess" data-discover="true">In-Process Transport</a></strong> - Learn about embedded scenarios</li>
<li class="vocs_ListItem"><strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="/clients" data-discover="true">Client Development</a></strong> - Build MCP clients for HTTP transport</li>
<li class="vocs_ListItem"><strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="/servers/basics" data-discover="true">Server Basics</a></strong> - Review fundamental server concepts</li>
</ul></article><footer class="vocs_Footer" data-layout="docs"><div class="vocs_Footer_container"></div></footer></div><div data-bottom-observer="true"></div></div></div>
  </body>
</html>
